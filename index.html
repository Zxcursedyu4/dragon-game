<!DOCTYPE html>
<html>
<head>
    <title>Dragon Empire</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: #121212;
            --card-color: #1e1e1e;
            --text-color: #e0e0e0;
            --accent-color: #bb86fc;
            --secondary-color: #03dac6;
            --button-bg: #3700b3;
            --button-hover: #6200ee;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            transition: all 0.3s;
        }
        
        .container {
            max-width: 100%;
            padding: 15px;
        }
        
        .tab-container {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid #333;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background: #252525;
            margin-right: 5px;
            border-radius: 8px 8px 0 0;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: var(--button-bg);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        .dragon-pen {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .dragon-card {
            background: var(--card-color);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            transition: transform 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .dragon-card:hover {
            transform: translateY(-5px);
        }
        
        .dragon-emoji {
            font-size: 50px;
            margin-bottom: 10px;
        }
        
        .dragon-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .dragon-rank {
            font-size: 12px;
            padding: 3px 8px;
            border-radius: 10px;
            display: inline-block;
            margin-bottom: 8px;
        }
        
        .rank-C { background: #757575; }
        .rank-B { background: #4caf50; }
        .rank-A { background: #2196f3; }
        .rank-S { background: #9c27b0; }
        .rank-SS { background: #ff9800; }
        .rank-SSS { background: #f44336; }
        
        .feed-btn {
            background: var(--button-bg);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 12px;
        }
        
        .feed-btn:hover {
            background: var(--button-hover);
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-between;
            background: #1e1e1e;
            padding: 10px 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .stat {
            display: flex;
            align-items: center;
        }
        
        .stat-icon {
            margin-right: 5px;
            font-size: 18px;
        }
        
        /* Roulette Styles */
        .roulette-container {
            text-align: center;
            margin-top: 20px;
        }
        
        .roulette-wheel {
            width: 250px;
            height: 250px;
            margin: 0 auto;
            position: relative;
            border-radius: 50%;
            background: #252525;
            border: 5px solid var(--accent-color);
            overflow: hidden;
            box-shadow: 0 0 20px rgba(187, 134, 252, 0.3);
        }
        
        .roulette-item {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: 100% 100%;
            left: 0;
            top: 0;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .roulette-center {
            position: absolute;
            width: 40px;
            height: 40px;
            background: var(--accent-color);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(187, 134, 252, 0.5);
        }
        
        .roulette-center:after {
            content: "";
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            border-width: 0 10px 15px;
            border-style: solid;
            border-color: transparent transparent var(--accent-color);
        }
        
        .spin-btn {
            background: var(--accent-color);
            color: #000;
            border: none;
            padding: 10px 25px;
            border-radius: 25px;
            font-weight: bold;
            margin-top: 20px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 0 15px rgba(187, 134, 252, 0.4);
        }
        
        .spin-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(187, 134, 252, 0.6);
        }
        
        .spin-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Shop Styles */
        .shop-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .shop-item {
            background: var(--card-color);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid #333;
            transition: all 0.3s;
        }
        
        .shop-item:hover {
            border-color: var(--accent-color);
            transform: translateY(-3px);
        }
        
        .shop-item-emoji {
            font-size: 40px;
            margin-bottom: 10px;
        }
        
        .shop-item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .shop-item-price {
            color: var(--secondary-color);
            margin-bottom: 10px;
        }
        
        .buy-btn {
            background: var(--button-bg);
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 12px;
        }
        
        .buy-btn:hover {
            background: var(--button-hover);
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--accent-color);
            color: #000;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 100;
            font-weight: bold;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            display: none;
        }
        
        /* Cooldown indicator */
        .cooldown {
            font-size: 12px;
            color: #aaa;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="notification" id="notification"></div>
    
    <div class="container">
        <div class="stats-bar">
            <div class="stat">
                <span class="stat-icon">üí∞</span>
                <span id="coins">1000</span>
            </div>
            <div class="stat">
                <span class="stat-icon">üçó</span>
                <span id="food">20</span>
            </div>
            <div class="stat">
                <span class="stat-icon">‚ú®</span>
                <span id="boost">0</span>
            </div>
        </div>
        
        <div class="tab-container">
            <div class="tab active" onclick="switchTab('dragons')">–î—Ä–∞–∫–æ–Ω—ã</div>
            <div class="tab" onclick="switchTab('roulette')">–†—É–ª–µ—Ç–∫–∞</div>
            <div class="tab" onclick="switchTab('shop')">–ú–∞–≥–∞–∑–∏–Ω</div>
        </div>
        
        <div id="dragons" class="tab-content active">
            <h2>–í–∞—à–∏ –¥—Ä–∞–∫–æ–Ω—ã</h2>
            <div class="dragon-pen" id="dragonPen">
                <!-- Dragons will be added here -->
            </div>
        </div>
        
        <div id="roulette" class="tab-content">
            <h2>–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä—É–ª–µ—Ç–∫–∞</h2>
            <p>–ö—Ä—É—Ç–∏—Ç–µ —Ä–∞–∑ –≤ 24 —á–∞—Å–∞ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ —Ü–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑—ã!</p>
            
            <div class="roulette-container">
                <div class="roulette-wheel" id="rouletteWheel">
                    <!-- Roulette items will be added here -->
                </div>
                <button class="spin-btn" id="spinBtn" onclick="spinRoulette()">–ö—Ä—É—Ç–∏—Ç—å!</button>
                <div class="cooldown" id="cooldown"></div>
            </div>
        </div>
        
        <div id="shop" class="tab-content">
            <h2>–ú–∞–≥–∞–∑–∏–Ω –¥—Ä–∞–∫–æ–Ω–æ–≤</h2>
            <p>–ü–æ–∫—É–ø–∞–π—Ç–µ –¥—Ä–∞–∫–æ–Ω–æ–≤ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–Ω–≥–æ–≤ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –±–æ–Ω—É—Å—ã!</p>
            
            <div class="shop-items" id="shopItems">
                <!-- Shop items will be added here -->
            </div>
        </div>
    </div>

    <script>
        // Game data
        const game = {
            coins: 1000,
            food: 20,
            boost: 0,
            dragons: [],
            lastSpin: null,
            dragonTypes: [
                { emoji: "üê≤", name: "–û–±—ã—á–Ω—ã–π –¥—Ä–∞–∫–æ–Ω", rank: "C", price: 100, bonus: "1x –º–æ–Ω–µ—Ç—ã" },
                { emoji: "üêâ", name: "–†–µ–¥–∫–∏–π –¥—Ä–∞–∫–æ–Ω", rank: "B", price: 300, bonus: "1.5x –º–æ–Ω–µ—Ç—ã" },
                { emoji: "üî•", name: "–û–≥–Ω–µ–Ω–Ω—ã–π –¥—Ä–∞–∫–æ–Ω", rank: "A", price: 800, bonus: "2x –º–æ–Ω–µ—Ç—ã + –æ–≥–Ω–µ–Ω–Ω—ã–π —â–∏—Ç" },
                { emoji: "ü¶é", name: "–î—Ä–∞–∫–æ–Ω-–Ω–µ–≤–∏–¥–∏–º–∫–∞", rank: "S", price: 2000, bonus: "3x –º–æ–Ω–µ—Ç—ã + –Ω–µ–≤–∏–¥–∏–º–æ—Å—Ç—å" },
                { emoji: "üêä", name: "–î—Ä–∞–∫–æ–Ω-–∫–æ—Ä–æ–ª—å", rank: "SS", price: 5000, bonus: "5x –º–æ–Ω–µ—Ç—ã + –∫–æ—Ä–æ–ª–µ–≤—Å–∫–∞—è –∞—É—Ä–∞" },
                { emoji: "‚ú®", name: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –¥—Ä–∞–∫–æ–Ω", rank: "SSS", price: 15000, bonus: "10x –º–æ–Ω–µ—Ç—ã + –≤—Å–µ –±–æ–Ω—É—Å—ã" }
            ],
            rouletteItems: [
                { type: "coins", value: 100, emoji: "üí∞", color: "#FFD700", text: "100 –º–æ–Ω–µ—Ç" },
                { type: "coins", value: 200, emoji: "üí∞", color: "#FFD700", text: "200 –º–æ–Ω–µ—Ç" },
                { type: "food", value: 10, emoji: "üçó", color: "#FF6347", text: "10 –∫–æ—Ä–º–∞" },
                { type: "boost", value: 1, emoji: "‚ö°", color: "#00BFFF", text: "–ë—É—Å—Ç +1" },
                { type: "dragon", value: "B", emoji: "üêâ", color: "#4CAF50", text: "–†–µ–¥–∫–∏–π –¥—Ä–∞–∫–æ–Ω" },
                { type: "dragon", value: "A", emoji: "üî•", color: "#2196F3", text: "–û–≥–Ω–µ–Ω–Ω—ã–π –¥—Ä–∞–∫–æ–Ω" },
                { type: "dragon", value: "S", emoji: "ü¶é", color: "#9C27B0", text: "–î—Ä–∞–∫–æ–Ω-–Ω–µ–≤–∏–¥–∏–º–∫–∞" },
                { type: "jackpot", value: "SSS", emoji: "‚ú®", color: "#F44336", text: "–î–ñ–ï–ö–ü–û–¢!" }
            ]
        };

        // Initialize Telegram WebApp
        Telegram.WebApp.expand();
        Telegram.WebApp.MainButton.setText('–ó–∞–∫—Ä—ã—Ç—å').show();
        Telegram.WebApp.MainButton.onClick(() => Telegram.WebApp.close());

        // Load saved game
        function loadGame() {
            const savedGame = localStorage.getItem('dragonGame');
            if (savedGame) {
                Object.assign(game, JSON.parse(savedGame));
            }
            
            // Add starter dragons if empty
            if (game.dragons.length === 0) {
                game.dragons = [
                    { type: "C", emoji: "üê≤", name: "–û–±—ã—á–Ω—ã–π –¥—Ä–∞–∫–æ–Ω", fedToday: 0 },
                    { type: "C", emoji: "üê≤", name: "–û–±—ã—á–Ω—ã–π –¥—Ä–∞–∫–æ–Ω", fedToday: 0 }
                ];
            }
            
            updateUI();
        }

        // Save game
        function saveGame() {
            localStorage.setItem('dragonGame', JSON.stringify(game));
        }

        // Update UI
        function updateUI() {
            // Update stats
            document.getElementById('coins').textContent = game.coins;
            document.getElementById('food').textContent = game.food;
            document.getElementById('boost').textContent = game.boost;
            
            // Update dragons
            const dragonPen = document.getElementById('dragonPen');
            dragonPen.innerHTML = '';
            
            game.dragons.forEach((dragon, index) => {
                const dragonType = game.dragonTypes.find(dt => dt.rank === dragon.type);
                const dragonCard = document.createElement('div');
                dragonCard.className = 'dragon-card';
                dragonCard.innerHTML = `
                    <div class="dragon-emoji">${dragon.emoji}</div>
                    <div class="dragon-name">${dragon.name}</div>
                    <div class="dragon-rank rank-${dragon.type}">${dragon.type}</div>
                    <div class="dragon-bonus">${dragonType ? dragonType.bonus : ''}</div>
                    <button class="feed-btn" onclick="feedDragon(${index})">–ö–æ—Ä–º–∏—Ç—å (1üçó)</button>
                `;
                dragonPen.appendChild(dragonCard);
            });
            
            // Update roulette cooldown
            updateRouletteCooldown();
            
            // Update shop
            updateShop();
            
            saveGame();
        }

        // Switch tabs
        function switchTab(tabId) {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelector(`.tab[onclick="switchTab('${tabId}')"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // Feed dragon
        function feedDragon(index) {
            if (game.food <= 0) {
                showNotification('–ù–µ—Ç –∫–æ—Ä–º–∞!');
                return;
            }
            
            const dragon = game.dragons[index];
            game.food--;
            
            // Calculate coins based on dragon rank
            let coinsEarned = 5;
            if (dragon.type === 'B') coinsEarned = 8;
            else if (dragon.type === 'A') coinsEarned = 12;
            else if (dragon.type === 'S') coinsEarned = 20;
            else if (dragon.type === 'SS') coinsEarned = 35;
            else if (dragon.type === 'SSS') coinsEarned = 60;
            
            // Apply boost
            coinsEarned *= (1 + game.boost * 0.5);
            coinsEarned = Math.floor(coinsEarned);
            
            game.coins += coinsEarned;
            dragon.fedToday = (dragon.fedToday || 0) + 1;
            
            showNotification(`+${coinsEarned} –º–æ–Ω–µ—Ç!`);
            updateUI();
            
            // Animate dragon card
            const dragonCards = document.querySelectorAll('.dragon-card');
            dragonCards[index].classList.add('pulse');
            setTimeout(() => {
                dragonCards[index].classList.remove('pulse');
            }, 500);
        }

        // Roulette functions
        function setupRoulette() {
            const wheel = document.getElementById('rouletteWheel');
            wheel.innerHTML = '';
            
            const center = document.createElement('div');
            center.className = 'roulette-center';
            center.innerHTML = 'üé∞';
            wheel.appendChild(center);
            
            const itemAngle = 360 / game.rouletteItems.length;
            
            game.rouletteItems.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'roulette-item';
                itemElement.style.transform = `rotate(${itemAngle * index}deg) skewY(${90 - itemAngle}deg)`;
                itemElement.style.background = item.color;
                itemElement.innerHTML = `<div style="transform: skewY(${itemAngle - 90}deg) rotate(${itemAngle/2}deg);">${item.emoji}</div>`;
                wheel.appendChild(itemElement);
            });
        }

        function updateRouletteCooldown() {
            const cooldownElement = document.getElementById('cooldown');
            const spinBtn = document.getElementById('spinBtn');
            
            if (game.lastSpin) {
                const now = new Date();
                const lastSpinDate = new Date(game.lastSpin);
                const hoursDiff = (now - lastSpinDate) / (1000 * 60 * 60);
                
                if (hoursDiff < 24) {
                    const hoursLeft = Math.floor(24 - hoursDiff);
                    const minutesLeft = Math.floor((24 - hoursDiff - hoursLeft) * 60);
                    cooldownElement.textContent = `–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤—Ä–∞—â–µ–Ω–∏—è: ${hoursLeft}—á ${minutesLeft}–º`;
                    spinBtn.disabled = true;
                    return;
                }
            }
            
            cooldownElement.textContent = '–ì–æ—Ç–æ–≤–æ –∫ –≤—Ä–∞—â–µ–Ω–∏—é!';
            spinBtn.disabled = false;
        }

        function spinRoulette() {
            const spinBtn = document.getElementById('spinBtn');
            const wheel = document.getElementById('rouletteWheel');
            
            if (spinBtn.disabled) return;
            
            spinBtn.disabled = true;
            game.lastSpin = new Date().toISOString();
            
            // Random spin (5-8 full rotations + random stop)
            const spinDegrees = 1800 + Math.floor(Math.random() * 1080);
            const winningIndex = Math.floor(Math.random() * game.rouletteItems.length);
            const itemAngle = 360 / game.rouletteItems.length;
            const stopAngle = spinDegrees - (winningIndex * itemAngle) - (itemAngle / 2);
            
            wheel.style.transition = 'transform 5s cubic-bezier(0.17, 0.67, 0.12, 0.99)';
            wheel.style.transform = `rotate(${spinDegrees}deg)`;
            
            setTimeout(() => {
                const prize = game.rouletteItems[winningIndex];
                claimPrize(prize);
                updateRouletteCooldown();
            }, 5000);
        }

        function claimPrize(prize) {
            let message = '';
            
            switch (prize.type) {
                case 'coins':
                    game.coins += prize.value;
                    message = `–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${prize.value} –º–æ–Ω–µ—Ç!`;
                    break;
                case 'food':
                    game.food += prize.value;
                    message = `–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${prize.value} –∫–æ—Ä–º–∞!`;
                    break;
                case 'boost':
                    game.boost += prize.value;
                    message = `–í—ã –ø–æ–ª—É—á–∏–ª–∏ –±—É—Å—Ç +${prize.value}!`;
                    break;
                case 'dragon':
                    const dragonType = game.dragonTypes.find(dt => dt.rank === prize.value);
                    if (dragonType) {
                        game.dragons.push({
                            type: dragonType.rank,
                            emoji: dragonType.emoji,
                            name: dragonType.name,
                            fedToday: 0
                        });
                        message = `–í—ã –ø–æ–ª—É—á–∏–ª–∏ ${dragonType.name} (${dragonType.rank})!`;
                    }
                    break;
                case 'jackpot':
                    const sssDragon = game.dragonTypes.find(dt => dt.rank === 'SSS');
                    if (sssDragon) {
                        game.dragons.push({
                            type: sssDragon.rank,
                            emoji: sssDragon.emoji,
                            name: sssDragon.name,
                            fedToday: 0
                        });
                        game.coins += 5000;
                        game.boost += 3;
                        message = `–î–ñ–ï–ö–ü–û–¢!!! –í—ã –ø–æ–ª—É—á–∏–ª–∏ ${sssDragon.name} + 5000 –º–æ–Ω–µ—Ç + –±—É—Å—Ç +3!`;
                    }
                    break;
            }
            
            showNotification(message);
            updateUI();
        }

        // Shop functions
        function updateShop() {
            const shopItems = document.getElementById('shopItems');
            shopItems.innerHTML = '';
            
            game.dragonTypes.forEach((dragon, index) => {
                const shopItem = document.createElement('div');
                shopItem.className = 'shop-item';
                shopItem.innerHTML = `
                    <div class="shop-item-emoji">${dragon.emoji}</div>
                    <div class="shop-item-name">${dragon.name}</div>
                    <div class="dragon-rank rank-${dragon.rank}">${dragon.rank}</div>
                    <div class="shop-item-bonus">${dragon.bonus}</div>
                    <div class="shop-item-price">${dragon.price} üí∞</div>
                    <button class="buy-btn" onclick="buyDragon(${index})">–ö—É–ø–∏—Ç—å</button>
                `;
                shopItems.appendChild(shopItem);
            });
        }

        function buyDragon(index) {
            const dragonType = game.dragonTypes[index];
            
            if (game.coins < dragonType.price) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!');
                return;
            }
            
            game.coins -= dragonType.price;
            game.dragons.push({
                type: dragonType.rank,
                emoji: dragonType.emoji,
                name: dragonType.name,
                fedToday: 0
            });
            
            showNotification(`–í—ã –∫—É–ø–∏–ª–∏ ${dragonType.name}!`);
            updateUI();
        }

        // Notification
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.opacity = '1';
            }, 10);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 300);
            }, 3000);
        }

        // Initialize game
        window.onload = function() {
            loadGame();
            setupRoulette();
        };
    </script>
</body>
</html>
