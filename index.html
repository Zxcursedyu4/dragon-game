<!DOCTYPE html>
<html>
<head>
    <title>Dragon RPG</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* Стили остаются прежними, но добавим класс для ботов */
        .bot-dragon {
            border: 2px solid #ff4444;
            background-color: rgba(255, 0, 0, 0.1);
        }
        .sell-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background-color: #777 !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Остальной интерфейс остается без изменений -->
        <div id="battle" class="tab-content">
            <h2>Арена</h2>
            <button id="fightBotBtn" class="action-btn">Сразиться с ботом</button>
            <div id="battleArena" style="display: none;">
                <!-- Боевая арена будет здесь -->
            </div>
        </div>
    </div>

    <script>
        const game = {
            // ... предыдущие свойства ...

            botNames: ["Огнедышащий", "Ледяной", "Громовой", "Теневой", "Каменный"],
            botTitles: ["Новичок", "Ученик", "Воин", "Мастер", "Легенда"],

            init() {
                // ... предыдущая инициализация ...
                document.getElementById('fightBotBtn').addEventListener('click', this.startBotBattle.bind(this));
            },

            createBotDragon() {
                const rank = this.getRandomRank();
                const type = this.dragonTypes.find(d => d.rank === rank);
                const name = this.botNames[Math.floor(Math.random() * this.botNames.length)];
                const title = this.botTitles[Math.floor(Math.random() * this.botTitles.length)];
                
                return {
                    id: "bot-" + Date.now(),
                    type: rank,
                    emoji: type.emoji,
                    name: `${name} ${title}`,
                    isBot: true,
                    level: Math.max(1, Math.floor(Math.random() * 5) + 1),
                    hp: type.hp,
                    maxHp: type.hp,
                    attack: type.attack,
                    defense: type.defense,
                    speed: type.speed,
                    skills: [...type.skills],
                    special: {...type.special}
                };
            },

            getRandomRank() {
                const rand = Math.random();
                if (rand < 0.5) return "C";
                if (rand < 0.8) return "B";
                if (rand < 0.95) return "A";
                return "S";
            },

            startBotBattle() {
                if (this.dragons.length === 0) {
                    this.showNotification("Нет драконов для боя!");
                    return;
                }

                const bot = this.createBotDragon();
                this.currentBattle = {
                    player: this.dragons[0], // Будем сражаться первым драконом
                    bot: bot,
                    turn: 0
                };

                this.showBattleArena();
                this.addBattleLog(`Бой с ${bot.name} начинается!`);
            },

            showBattleArena() {
                // Показываем арену и обновляем информацию
                document.getElementById('battleArena').style.display = 'block';
                this.updateBattleUI();
            },

            updateBattleUI() {
                if (!this.currentBattle) return;
                
                const { player, bot } = this.currentBattle;
                // Обновляем UI боя (здесь должен быть ваш код отображения боя)
            },

            sellDragon(dragonId) {
                if (this.dragons.length <= 1) {
                    this.showNotification("Нельзя продать последнего дракона!");
                    return false;
                }

                const dragonIndex = this.dragons.findIndex(d => d.id === dragonId);
                if (dragonIndex === -1) return false;

                const dragon = this.dragons[dragonIndex];
                const sellPrice = Math.floor(this.getDragonPrice(dragon.type) * 0.7);

                this.coins += sellPrice;
                this.dragons.splice(dragonIndex, 1);
                this.showNotification(`Продан ${dragon.name} за ${sellPrice} монет`);
                this.updateUI();
                return true;
            },

            updateUI() {
                // Обновляем кнопки продажи
                this.dragons.forEach(dragon => {
                    const sellBtn = document.querySelector(`.sell-btn[data-id="${dragon.id}"]`);
                    if (sellBtn) {
                        sellBtn.disabled = this.dragons.length <= 1;
                    }
                });
                // ... остальное обновление UI
            },

            // ... остальные методы ...
        };

        // Инициализация игры
        document.addEventListener('DOMContentLoaded', () => game.init());
    </script>
</body>
</html>
